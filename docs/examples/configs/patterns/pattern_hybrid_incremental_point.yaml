environment: dev  # Hybrid incremental point-in-time scenario
pattern_id: pattern6_hybrid_incremental_point
domain: retail_demo  # Domain directory for Bronze/Silver samples
system: retail_demo  # System identifier path component
entity: orders  # Entity name referenced in metadata and path keys

storage:
  source:
    backend: s3
    prefix: source_samples/
  bronze:
    backend: s3
    prefix: bronze_samples/
  silver:
    backend: s3
    prefix: silver_samples/

# Flip to local storage for debugging by using backend=local and matching prefixes to ./sampledata/, sampledata/bronze_samples/, sampledata/silver_samples/

path_structure:
  bronze:
    system_key: "system"
    entity_key: "table"
    pattern_key: "pattern"
    date_key: "dt"
  silver:
    domain_key: "domain"  # Silver: business domain (curated data organization)
    entity_key: "entity"  # Silver: curated entity/dataset name
    version_key: "v"  # Silver: schema/transformation version prefix
    pattern_key: "pattern"  # Silver: optional pattern for Bronze traceability
    load_date_key: "load_date"  # Silver: data load date

bronze:
  enabled: true
  source_type: file
  path_pattern: sample=pattern6_hybrid_incremental_point/system=retail_demo/table=orders/dt=2025-11-24/delta/delta-part-0001.csv
  partition_column: run_date
  options:
    format: csv
    load_pattern: cdc
    pattern_folder: pattern6_hybrid_incremental_point
    delta_mode: point_in_time
    partitioning_strategy: timestamp
    match_dir: delta
    output_formats:
      # - csv
      - parquet

silver:
  enabled: true
  include_pattern_folder: true  # Include pattern in path for Bronze traceability
  entity_kind: derived_state
  history_mode: latest_only  # Only emit current snapshot
  schema_mode: allow_new_columns
  natural_keys:
    - order_id
  change_ts_column: changed_at
  attributes:
    - status
  partition_by: []  # Not partitioned â€“ latest-only current view
  delete_mode: ignore
  record_time_column: "changed_at"
  record_time_partition: null
  load_batch_id_column: "load_batch_id"
